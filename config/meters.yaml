# Meter Configuration
# Defines all physical, master, and virtual meters

meters:
  # Master Meters (combine multiple physical meters across time periods)
  - meter_id: "strom_total"
    type: "master"
    output_unit: "kWh"
    description: "Total electricity consumption across all periods"
    periods:
      - start_date: "2020-01-01"
        end_date: "2024-11-26"
        composition_type: "sum"
        source_meters:
          - "strom_1LOG0007013695_NT"
          - "strom_1LOG0007013695_HT"
        source_unit: "kWh"
      - start_date: "2024-11-27"
        end_date: "9999-12-31"
        composition_type: "single"
        source_meters:
          - "haupt_strom"
        source_unit: "kWh"
        apply_offset_from_previous_period: true

  - meter_id: "gas_total"
    type: "master"
    output_unit: "m³"
    description: "Total gas consumption across meter replacements"
    periods:
      - start_date: "2020-06-01"
        end_date: "2024-11-12"
        composition_type: "single"
        source_meters:
          - "gas_zahler_alt"
        source_unit: "m³"
      - start_date: "2024-11-13"
        end_date: "9999-12-31"
        composition_type: "single"
        source_meters:
          - "gas_zahler"
        source_unit: "m³"
        apply_offset_from_previous_period: true

  # Virtual Meters (calculated from other meters)
  - meter_id: "eg_kalfire"
    type: "virtual"
    output_unit: "m³"
    description: "Gas consumption for EG Kalfire fireplace"
    calculation_type: "subtraction"
    base_meter: "gas_total"
    subtract_meters:
      - "gastherme_gesamt"
    subtract_meter_conversions:
      gastherme_gesamt:
        from_unit: "kWh"
        to_unit: "m³"

  - meter_id: "strom_allgemein"
    type: "virtual"
    output_unit: "kWh"
    description: "General electricity consumption (total minus individual meters)"
    calculation_type: "subtraction"
    base_meter: "strom_total"
    subtract_meters:
      - "eg_strom"
      - "og1_strom"
      - "og2_strom"

  # Physical Meters - Electricity
  - meter_id: "haupt_strom"
    type: "physical"
    output_unit: "kWh"
    installation_date: "2024-11-27"
    description: "Main electricity meter (new installation)"

  - meter_id: "strom_1LOG0007013695_NT"
    type: "physical"
    output_unit: "kWh"
    deinstallation_date: "2024-11-26"
    description: "Old electricity meter - night tariff"

  - meter_id: "strom_1LOG0007013695_HT"
    type: "physical"
    output_unit: "kWh"
    deinstallation_date: "2024-11-26"
    description: "Old electricity meter - high tariff"

  - meter_id: "eg_strom"
    type: "physical"
    output_unit: "kWh"
    installation_date: "2022-01-01"
    description: "Ground floor electricity"

  - meter_id: "og1_strom"
    type: "physical"
    output_unit: "kWh"
    installation_date: "2022-01-01"
    description: "First floor electricity"

  - meter_id: "og2_strom"
    type: "physical"
    output_unit: "kWh"
    installation_date: "2022-01-01"
    description: "Second floor electricity"

  # Physical Meters - Gas
  - meter_id: "gas_zahler"
    type: "physical"
    output_unit: "m³"
    installation_date: "2024-11-12"
    description: "Current gas meter"

  - meter_id: "gas_zahler_alt"
    type: "physical"
    output_unit: "m³"
    installation_date: "2020-06-01"
    deinstallation_date: "2024-11-12"
    description: "Previous gas meter (replaced)"

  # Physical Meters - Gas Heating System
  - meter_id: "gastherme_gesamt"
    type: "physical"
    output_unit: "kWh"
    installation_date: "2022-01-01"
    description: "Gas heating system total consumption"

  - meter_id: "gastherme_heizen"
    type: "physical"
    output_unit: "kWh"
    installation_date: "2022-01-01"
    description: "Gas heating system - heating only"

  - meter_id: "gastherme_warmwasser"
    type: "physical"
    output_unit: "kWh"
    installation_date: "2022-01-01"
    description: "Gas heating system - hot water only"

  # Physical Meters - Water
  - meter_id: "haupt_wasser"
    type: "physical"
    output_unit: "m³"
    installation_date: "2022-01-01"
    description: "Main water meter"

  - meter_id: "og1_wasser_kalt"
    type: "physical"
    output_unit: "m³"
    installation_date: "2022-05-01"
    description: "First floor cold water"

  - meter_id: "og1_wasser_warm"
    type: "physical"
    output_unit: "m³"
    installation_date: "2022-04-01"
    description: "First floor hot water"

  - meter_id: "og2_wasser_kalt"
    type: "physical"
    output_unit: "m³"
    installation_date: "2022-09-01"
    description: "Second floor cold water"

  - meter_id: "og2_wasser_warm"
    type: "physical"
    output_unit: "m³"
    installation_date: "2022-09-01"
    description: "Second floor hot water"

  # Physical Meters - Heat
  - meter_id: "eg_nord_heat"
    type: "physical"
    output_unit: "MWh"
    installation_date: "2022-01-01"
    description: "Heat Energy EG Nord"

  - meter_id: "og1_heat"
    type: "physical"
    output_unit: "MWh"
    installation_date: "2022-01-05"
    description: "Heat OG1"

  - meter_id: "og2_heat"
    type: "physical"
    output_unit: "MWh"
    installation_date: "2022-01-09"
    description: "Heat OG2"

  - meter_id: "eg_sud_heat"
    type: "physical"
    output_unit: "MWh"
    installation_date: "2022-01-01"
    description: "Heat EG Sud"

  - meter_id: "buro_heat"
    type: "physical"
    output_unit: "MWh"
    installation_date: "2022-01-05"
    description: "Heat Buro"

  # Physical Meters - Solar
  - meter_id: "solarspeicher"
    type: "physical"
    output_unit: "kWh"
    installation_date: "2022-01-01"
    description: "Solar storage system"
