INFLUX_URL=http://192.168.1.75:8086
INFLUX_TOKEN=OcXhfQCBA6rKpIN4f5JSrmtp2xxgjk4vBt1jAqpjb-g1sIh1nUDdB8Ljo-ZMYxjMQJEicDncrZ1QE2PzH9nzZg==
INFLUX_ORG=0d72e1f6b38972fa
INFLUX_BUCKET=lampfi
GAS_ENERGY_CONTENT=11.504
GAS_Z_FACTOR=0.8885

METER_CONFIGURATION_JSON='[
  {
    "meter_id": "strom_total",
    "type": "master",
    "output_unit": "kWh",
    "description": "Total electricity consumption across all periods",
    "periods": [
      {"start_date": "2020-01-01", "end_date": "2024-11-26", "composition_type": "sum", "source_meters": ["strom_1LOG0007013695_NT", "strom_1LOG0007013695_HT"], "source_unit": "kWh"},
      {"start_date": "2024-11-27", "end_date": "9999-12-31", "composition_type": "single", "source_meters": ["haupt_strom"], "source_unit": "kWh", "apply_offset_from_previous_period": true}
    ]
  },
  {
    "meter_id": "gas_total",
    "type": "master", 
    "output_unit": "m³",
    "description": "Total gas consumption across meter replacements",
    "periods": [
      {"start_date": "2020-06-01", "end_date": "2024-11-12", "composition_type": "single", "source_meters": ["gas_zahler_alt"], "source_unit": "m³"},
      {"start_date": "2024-11-13", "end_date": "9999-12-31", "composition_type": "single", "source_meters": ["gas_zahler"], "source_unit": "m³", "apply_offset_from_previous_period": true}
    ]
  },
  {
    "meter_id": "eg_kalfire",
    "type": "virtual",
    "output_unit": "m³", 
    "description": "Gas consumption for EG Kalfire fireplace",
    "calculation_type": "subtraction",
    "base_meter": "gas_total",
    "subtract_meters": ["gastherme_gesamt"],
    "subtract_meter_conversions": {
      "gastherme_gesamt": {"from_unit": "kWh", "to_unit": "m³"}
    }
  },
  {
    "meter_id": "strom_allgemein", 
    "type": "virtual",
    "output_unit": "kWh",
    "description": "General electricity consumption (total minus individual meters)",
    "calculation_type": "subtraction", 
    "base_meter": "strom_total",
    "subtract_meters": ["eg_strom", "og1_strom", "og2_strom"]
  },
  {
    "meter_id": "haupt_strom",
    "type": "physical",
    "output_unit": "kWh",
    "installation_date": "2024-11-27",
    "description": "Main electricity meter (new installation)"
  },
  {
    "meter_id": "eg_nord_heat",
    "type": "physical",
    "output_unit": "MWh",
    "installation_date": "2022-01-01",
    "description": "Heat Energy EG Nord"
  },
  {
    "meter_id": "haupt_wasser", 
    "type": "physical",
    "output_unit": "m³",
    "installation_date": "2022-01-01",
    "description": "Main water meter"
  },
  {
    "meter_id": "gas_zahler",
    "type": "physical", 
    "output_unit": "m³",
    "installation_date": "2024-11-12",
    "description": "Current gas meter"
  },
  {
    "meter_id": "gas_zahler_alt",
    "type": "physical",
    "output_unit": "m³", 
    "installation_date": "2020-06-01",
    "deinstallation_date": "2024-11-12",
    "description": "Previous gas meter (replaced)"
  },
  {
    "meter_id": "strom_1LOG0007013695_NT",
    "type": "physical",
    "output_unit": "kWh",
    "deinstallation_date": "2024-11-26", 
    "description": "Old electricity meter - night tariff"
  },
  {
    "meter_id": "strom_1LOG0007013695_HT", 
    "type": "physical",
    "output_unit": "kWh",
    "deinstallation_date": "2024-11-26",
    "description": "Old electricity meter - high tariff"
  },
  {
    "meter_id": "eg_strom",
    "type": "physical",
    "output_unit": "kWh",
    "installation_date": "2022-01-01",
    "description": "Ground floor electricity"
  },
  {
    "meter_id": "og1_strom", 
    "type": "physical",
    "output_unit": "kWh", 
    "installation_date": "2022-01-01",
    "description": "First floor electricity"
  },
  {
    "meter_id": "og2_strom",
    "type": "physical",
    "output_unit": "kWh",
    "installation_date": "2022-01-01", 
    "description": "Second floor electricity"
  },
  {
    "meter_id": "og1_wasser_kalt",
    "type": "physical",
    "output_unit": "m³",
    "installation_date": "2022-05-01",
    "description": "First floor cold water"
  },
  {
    "meter_id": "og1_wasser_warm",
    "type": "physical", 
    "output_unit": "m³",
    "installation_date": "2022-04-01",
    "description": "First floor hot water"
  },
  {
    "meter_id": "og2_wasser_kalt",
    "type": "physical",
    "output_unit": "m³", 
    "installation_date": "2022-09-01",
    "description": "Second floor cold water"
  },
  {
    "meter_id": "og2_wasser_warm",
    "type": "physical",
    "output_unit": "m³",
    "installation_date": "2022-09-01",
    "description": "Second floor hot water"
  },
  {
    "meter_id": "gastherme_gesamt",
    "type": "physical", 
    "output_unit": "kWh",
    "installation_date": "2022-01-01",
    "description": "Gas heating system total consumption"
  },
  {
    "meter_id": "gastherme_heizen",
    "type": "physical",
    "output_unit": "kWh",
    "installation_date": "2022-01-01", 
    "description": "Gas heating system - heating only"
  },
  {
    "meter_id": "gastherme_warmwasser",
    "type": "physical",
    "output_unit": "kWh",
    "installation_date": "2022-01-01",
    "description": "Gas heating system - hot water only"
  },
  {
    "meter_id": "solarspeicher",
    "type": "physical",
    "output_unit": "kWh", 
    "installation_date": "2022-01-01",
    "description": "Solar storage system"
  },
  {
    "meter_id": "og1_heat",
    "type": "physical",
    "output_unit": "MWh", 
    "installation_date": "2022-01-05",
    "description": "Heat OG1"
  },
  {
    "meter_id": "og2_heat",
    "type": "physical",
    "output_unit": "MWh", 
    "installation_date": "2022-01-09",
    "description": "Heat OG1"
  },
  {
    "meter_id": "eg_sud_heat",
    "type": "physical",
    "output_unit": "MWh", 
    "installation_date": "2022-01-01",
    "description": "Heat OG1"
  },
  {
    "meter_id": "buro_heat",
    "type": "physical",
    "output_unit": "MWh", 
    "installation_date": "2022-01-05",
    "description": "Heat OG1"
  }
]'

# Seasonal consumption patterns (monthly percentages that sum to 100%)
# Format: {"meter_id": {"monthly_percentages": [Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec]}}
SEASONAL_PATTERNS_JSON='{
  "eg_strom": {
    "monthly_percentages": [12.5, 11.0, 10.0, 8.5, 6.5, 5.0, 4.5, 5.0, 6.5, 8.0, 10.5, 12.0]
  },
  "gas_total": {
    "monthly_percentages": [15.1, 12.0, 12.5, 8.1, 3.5, 3.2, 2.7, 3.6, 5.2, 8.4, 12.2, 14.5]
  },
  "gastherme_gesamt": {
    "monthly_percentages": [15.1, 12.0, 12.5, 8.1, 3.5, 3.2, 2.7, 3.6, 5.2, 8.4, 12.2, 14.5]
  },
  "gastherme_heizen": {
    "monthly_percentages": [15.1, 12.0, 12.5, 8.1, 3.5, 3.2, 2.7, 3.6, 5.2, 8.4, 12.2, 14.5]
  },
  "gas_zahler_alt": {
    "monthly_percentages": [15.1, 12.0, 12.5, 8.1, 3.5, 3.2, 2.7, 3.6, 5.2, 8.4, 12.2, 14.5]
  },
  "gas_zahler": {
    "monthly_percentages": [16.1, 13.0, 12.5, 8.1, 3.5, 2.2, 1.7, 1.6, 5.2, 8.4, 12.2, 15.5]
  },
  "strom_total": {
    "monthly_percentages": [16.1, 13.0, 12.5, 8.1, 3.5, 2.2, 1.7, 1.6, 5.2, 8.4, 12.2, 15.5]
  },
  "gastherme_warmwasser": {
    "monthly_percentages": [12, 11, 10, 8, 7, 6, 6, 6, 6, 6, 10, 12]
  },
  "eg_nord_heat": {
    "monthly_percentages": [17.1, 14.0, 12.5, 8.1, 2.5, 1.2, 0.7, 0.6, 5.2, 8.4, 13.2, 16.5]
  },
  "buro_heat": {
    "monthly_percentages": [17.1, 14.0, 12.5, 8.1, 2.5, 1.2, 0.7, 0.6, 5.2, 8.4, 13.2, 16.5]
  },
  "eg_sud_heat": {
    "monthly_percentages": [17.1, 14.0, 12.5, 8.1, 2.5, 1.2, 0.7, 0.6, 5.2, 8.4, 13.2, 16.5]
  },
  "og1_heat": {
    "monthly_percentages": [17.1, 14.0, 12.5, 8.1, 2.5, 1.2, 0.7, 0.6, 5.2, 8.4, 13.2, 16.5]
  },
  "og2_heat": {
    "monthly_percentages": [17.1, 14.0, 12.5, 8.1, 2.5, 1.2, 0.7, 0.6, 5.2, 8.4, 13.2, 16.5]
  },
  "solarspeicher": {
    "monthly_percentages": [3.3, 4.2, 7.2, 11.6, 12.9, 13.4, 13.5, 11.5, 9.5, 7.2, 3.4, 2.4]
  },
  "strom_1LOG0007013695_NT": {
    "monthly_percentages": [12.5, 11.0, 10.0, 8.5, 6.5, 5.0, 4.5, 5.0, 6.5, 8.0, 10.5, 12.0]
  },
  "strom_1LOG0007013695_HT": {
    "monthly_percentages": [12.5, 11.0, 10.0, 8.5, 6.5, 5.0, 4.5, 5.0, 6.5, 8.0, 10.5, 12.0]
  }
}'
